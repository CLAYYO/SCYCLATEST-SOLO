---
import Layout from '../../layouts/Layout.astro';
import { supabase } from '../../lib/supabase';
import { MEMBERSHIP_TYPES } from '../../utils';

// Fetch membership data from Supabase
const { data: members } = await supabase
  .from('members')
  .select('membership_type')
  .eq('status', 'active');

// Calculate membership statistics
const membershipStats = members ? members.reduce((acc, member) => {
  acc[member.membership_type] = (acc[member.membership_type] || 0) + 1;
  return acc;
}, {}) : {};

const totalMembers = members ? members.length : 0;

// Membership type details
const membershipDetails = {
  full: {
    name: 'Full Membership',
    price: '£450',
    period: 'per year',
    description: 'Complete access to all club facilities and services',
    benefits: [
      'Unlimited use of club facilities',
      'Mooring and berthing privileges',
      'Access to The Cove restaurant',
      'Participation in all racing events',
      'Training course discounts',
      'Social event invitations',
      'Voting rights at AGM',
      'Guest privileges'
    ],
    color: 'bg-navy-700 text-white'
  },
  associate: {
    name: 'Associate Membership',
    price: '£275',
    period: 'per year',
    description: 'Perfect for occasional sailors and social members',
    benefits: [
      'Access to club facilities',
      'The Cove restaurant access',
      'Social event invitations',
      'Training course discounts',
      'Limited racing participation',
      'Guest privileges (restricted)'
    ],
    color: 'bg-blue-600 text-white'
  },
  junior: {
    name: 'Junior Membership',
    price: '£125',
    period: 'per year (under 18)',
    description: 'Encouraging the next generation of sailors',
    benefits: [
      'Full facility access',
      'Youth training programs',
      'Junior racing events',
      'Mentorship opportunities',
      'Social activities',
      'Equipment loan scheme'
    ],
    color: 'bg-green-600 text-white'
  },
  family: {
    name: 'Family Membership',
    price: '£650',
    period: 'per year (2 adults + children)',
    description: 'Great value for sailing families',
    benefits: [
      'All full membership benefits',
      'Covers 2 adults + children under 18',
      'Family training packages',
      'Priority booking for events',
      'Additional guest privileges',
      'Family social activities'
    ],
    color: 'bg-purple-600 text-white'
  },
  honorary: {
    name: 'Honorary Membership',
    price: 'By invitation',
    period: 'lifetime',
    description: 'Recognizing exceptional service to the club',
    benefits: [
      'All full membership benefits',
      'Lifetime membership',
      'Special recognition',
      'Committee participation rights'
    ],
    color: 'bg-gold-600 text-white'
  }
};
---

<Layout title="Membership - South Caernarvonshire Yacht Club">
  <!-- Hero Section -->
  <section class="bg-gradient-to-r from-navy-900 to-navy-700 text-white py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center">
        <h1 class="text-4xl md:text-5xl font-serif font-bold mb-4">
          Join Our Community
        </h1>
        <p class="text-xl text-navy-100 max-w-3xl mx-auto mb-8">
          Become part of a sailing tradition that has been thriving in Cardigan Bay since 1924
        </p>
        
        {totalMembers > 0 && (
          <div class="inline-flex items-center bg-white/10 backdrop-blur-sm rounded-lg px-6 py-3">
            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
              <path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3z" />
            </svg>
            <span class="text-lg font-semibold">{totalMembers} Active Members</span>
          </div>
        )}
      </div>
    </div>
  </section>

  <!-- Membership Types -->
  <section class="py-16 bg-gray-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-serif font-bold text-navy-900 mb-4">
          Membership Options
        </h2>
        <p class="text-xl text-gray-600 max-w-3xl mx-auto">
          Choose the membership type that best suits your sailing lifestyle and commitment level
        </p>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {Object.entries(membershipDetails).map(([type, details]) => {
          const memberCount = membershipStats[type] || 0;
          
          return (
            <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow">
              <div class={`${details.color} px-6 py-4`}>
                <h3 class="text-xl font-bold">{details.name}</h3>
                <div class="mt-2">
                  <span class="text-2xl font-bold">{details.price}</span>
                  <span class="text-sm opacity-90 ml-1">{details.period}</span>
                </div>
              </div>
              
              <div class="px-6 py-6">
                <p class="text-gray-600 mb-6">{details.description}</p>
                
                <ul class="space-y-3 mb-6">
                  {details.benefits.map(benefit => (
                    <li class="flex items-start">
                      <svg class="w-5 h-5 text-green-500 mr-2 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                      </svg>
                      <span class="text-gray-700">{benefit}</span>
                    </li>
                  ))}
                </ul>
                
                {memberCount > 0 && (
                  <div class="text-sm text-gray-500 mb-4">
                    {memberCount} current {memberCount === 1 ? 'member' : 'members'}
                  </div>
                )}
                
                <a
                  href="/membership/apply"
                  class="block w-full text-center px-4 py-2 bg-navy-700 text-white font-medium rounded-md hover:bg-navy-800 focus:outline-none focus:ring-2 focus:ring-navy-500 transition-colors"
                >
                  Apply Now
                </a>
              </div>
            </div>
          );
        })}
      </div>
    </div>
  </section>

  <!-- Why Join SCYC -->
  <section class="py-16 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-serif font-bold text-navy-900 mb-4">
          Why Join SCYC?
        </h2>
        <p class="text-xl text-gray-600 max-w-3xl mx-auto">
          Discover what makes our club special and why sailors have called SCYC home for nearly a century
        </p>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        <div class="text-center">
          <div class="bg-navy-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-navy-700" fill="currentColor" viewBox="0 0 20 20">
              <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z" />
            </svg>
          </div>
          <h3 class="text-xl font-bold text-navy-900 mb-2">Prime Location</h3>
          <p class="text-gray-600">
            Located in the heart of Abersoch with direct access to the beautiful waters of Cardigan Bay
          </p>
        </div>
        
        <div class="text-center">
          <div class="bg-navy-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-navy-700" fill="currentColor" viewBox="0 0 20 20">
              <path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3z" />
            </svg>
          </div>
          <h3 class="text-xl font-bold text-navy-900 mb-2">Vibrant Community</h3>
          <p class="text-gray-600">
            Join a welcoming community of sailing enthusiasts, from beginners to seasoned racers
          </p>
        </div>
        
        <div class="text-center">
          <div class="bg-navy-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-navy-700" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
            </svg>
          </div>
          <h3 class="text-xl font-bold text-navy-900 mb-2">Excellent Facilities</h3>
          <p class="text-gray-600">
            Modern facilities including moorings, boat storage, training center, and The Cove restaurant
          </p>
        </div>
        
        <div class="text-center">
          <div class="bg-navy-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-navy-700" fill="currentColor" viewBox="0 0 20 20">
              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
            </svg>
          </div>
          <h3 class="text-xl font-bold text-navy-900 mb-2">Racing Excellence</h3>
          <p class="text-gray-600">
            Competitive racing program with events for all skill levels and boat classes
          </p>
        </div>
        
        <div class="text-center">
          <div class="bg-navy-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-navy-700" fill="currentColor" viewBox="0 0 20 20">
              <path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z" />
            </svg>
          </div>
          <h3 class="text-xl font-bold text-navy-900 mb-2">Training Programs</h3>
          <p class="text-gray-600">
            RYA certified training courses from beginner to advanced levels with qualified instructors
          </p>
        </div>
        
        <div class="text-center">
          <div class="bg-navy-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-navy-700" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M12 1.586l-4 4v12.828l4-4V1.586zM3.707 3.293A1 1 0 002 4v10a1 1 0 00.293.707L6 18.414V5.586L3.707 3.293zM17.707 5.293L14 1.586v12.828l2.293 2.293A1 1 0 0018 16V6a1 1 0 00-.293-.707z" clip-rule="evenodd" />
            </svg>
          </div>
          <h3 class="text-xl font-bold text-navy-900 mb-2">Rich Heritage</h3>
          <p class="text-gray-600">
            Nearly 100 years of sailing tradition and maritime heritage in one of Wales' most beautiful locations
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Application Process -->
  <section class="py-16 bg-gray-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-serif font-bold text-navy-900 mb-4">
          How to Apply
        </h2>
        <p class="text-xl text-gray-600 max-w-3xl mx-auto">
          Joining SCYC is straightforward. Follow these simple steps to become part of our sailing community
        </p>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div class="text-center">
          <div class="bg-navy-700 text-white rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-4 text-xl font-bold">
            1
          </div>
          <h3 class="text-lg font-bold text-navy-900 mb-2">Choose Membership</h3>
          <p class="text-gray-600">
            Select the membership type that best fits your needs and sailing goals
          </p>
        </div>
        
        <div class="text-center">
          <div class="bg-navy-700 text-white rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-4 text-xl font-bold">
            2
          </div>
          <h3 class="text-lg font-bold text-navy-900 mb-2">Submit Application</h3>
          <p class="text-gray-600">
            Complete our online application form or download and submit a paper application
          </p>
        </div>
        
        <div class="text-center">
          <div class="bg-navy-700 text-white rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-4 text-xl font-bold">
            3
          </div>
          <h3 class="text-lg font-bold text-navy-900 mb-2">Committee Review</h3>
          <p class="text-gray-600">
            Our membership committee will review your application and may arrange a brief meeting
          </p>
        </div>
        
        <div class="text-center">
          <div class="bg-navy-700 text-white rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-4 text-xl font-bold">
            4
          </div>
          <h3 class="text-lg font-bold text-navy-900 mb-2">Welcome Aboard</h3>
          <p class="text-gray-600">
            Once approved, pay your membership fee and start enjoying all club benefits
          </p>
        </div>
      </div>
      
      <div class="text-center mt-12">
        <a
          href="/membership/apply"
          class="inline-flex items-center px-8 py-3 bg-navy-700 text-white font-medium rounded-md hover:bg-navy-800 focus:outline-none focus:ring-2 focus:ring-navy-500 transition-colors text-lg"
        >
          Start Your Application
          <svg class="ml-2 w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" />
          </svg>
        </a>
      </div>
    </div>
  </section>

  <!-- Contact Information -->
  <section class="py-16 bg-navy-900 text-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="max-w-2xl mx-auto text-center">
        <h2 class="text-3xl font-serif font-bold mb-4">
          Questions About Membership?
        </h2>
        <p class="text-xl text-navy-100 mb-8">
          Our membership team is here to help you find the perfect membership option
        </p>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
          <div class="bg-white/10 backdrop-blur-sm rounded-lg p-6">
            <h3 class="text-lg font-bold mb-2">Membership Secretary</h3>
            <p class="text-navy-100 mb-2">Sarah Williams</p>
            <a href="mailto:membership@scyc.co.uk" class="text-gold-400 hover:text-gold-300">
              membership@scyc.co.uk
            </a>
            <p class="text-navy-100 mt-2">01758 712338</p>
          </div>
          
          <div class="bg-white/10 backdrop-blur-sm rounded-lg p-6">
            <h3 class="text-lg font-bold mb-2">Club Office</h3>
            <p class="text-navy-100 mb-2">Open Daily 9am-5pm</p>
            <a href="mailto:office@scyc.co.uk" class="text-gold-400 hover:text-gold-300">
              office@scyc.co.uk
            </a>
            <p class="text-navy-100 mt-2">01758 712338</p>
          </div>
        </div>
        
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a
            href="/contact"
            class="px-6 py-3 bg-gold-600 text-white font-medium rounded-md hover:bg-gold-700 focus:outline-none focus:ring-2 focus:ring-gold-500 transition-colors"
          >
            Contact Us
          </a>
          <a
            href="/documents"
            class="px-6 py-3 border border-white text-white font-medium rounded-md hover:bg-white hover:text-navy-900 focus:outline-none focus:ring-2 focus:ring-white transition-colors"
          >
            Download Forms
          </a>
        </div>
      </div>
    </div>
  </section>
</Layout>